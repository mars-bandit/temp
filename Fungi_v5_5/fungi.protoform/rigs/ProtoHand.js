import App from "../../fungi/App.js";

const MAXIMO_BONES = [
	{ "name":"RightHand","len":0.15,"idx":0,"p_idx":null,"pos":[0,0,0],"rot":[0,0,0,1]},

	{ "name":"RightHandThumb1","len":0.041,"idx":1,"p_idx":0,"pos":[-0.015,0.024,0.026],"rot":[0.22176654636859894,0.05947277694940567,0.25208544731140137,0.9400720596313477]},
	{ "name":"RightHandThumb2","len":0.034,"idx":2,"p_idx":1,"pos":[0,0.041,0],"rot":[0.00034027191577479243,-0.00019238849927205592,-0.0003856124822050333,0.9999998211860657]},
	{ "name":"RightHandThumb3","len":0.03,"idx":3,"p_idx":2,"pos":[0,0.034,0],"rot":[-0.011897333897650242,0.00195137073751539,0.004018437582999468,0.9999192357063293]},

	{ "name":"RightHandIndex1","len":0.036,"idx":4,"p_idx":0,"pos":[-0.0051,0.087,0.035],"rot":[-0.0000033692147098918213,0.0000033974647521972656,-1.1446789696667459e-11,1]},
	{ "name":"RightHandIndex2","len":0.028,"idx":5,"p_idx":4,"pos":[0,0.036,0],"rot":[0.000005616404450847767,-0.000005643691110890359,-0.0000020674101506301668,1]},
	{ "name":"RightHandIndex3","len":0.02,"idx":6,"p_idx":5,"pos":[0,0.0288,0],"rot":[0.000002786867753457045,-0.000002750003659457434,0.000012031735423079226,1]},

	{ "name":"RightHandMiddle1","len":0.036,"idx":7,"p_idx":0,"pos":[0,0.094,0.011],"rot":[-0.000003373543677298585,0.0000033974647521972656,1.1594199558762064e-11,1]},
	{ "name":"RightHandMiddle2","len":0.029,"idx":8,"p_idx":7,"pos":[0,0.036,0],"rot":[-0.000003787220066442387,0.0000038214084270293824,-0.000002019868361458066,1]},
	{ "name":"RightHandMiddle3","len":0.02,"idx":9,"p_idx":8,"pos":[0,0.029,0],"rot":[0.000003721492703334661,-0.0000037618035548803164,0.0000020198690435790922,1]},

	{ "name":"RightHandRing1","len":0.031,"idx":10,"p_idx":0,"pos":[-0.0004,0.091,-0.0137],"rot":[-0.000003366203372934251,0.000003397464979570941,-1.1436558297606148e-11,1]},
	{ "name":"RightHandRing2","len":0.029,"idx":11,"p_idx":10,"pos":[0,0.031,0],"rot":[0.000008235279892687686,-0.000008292319762404077,-0.000006086941539251711,1]},
	{ "name":"RightHandRing3","len":0.02,"idx":12,"p_idx":11,"pos":[0,0.029,0],"rot":[-0.000015700450603617355,0.00001574820271343924,0.000015092553439899348,1]},
	
	{ "name":"RightHandPinky1","len":0.036,"idx":13,"p_idx":0,"pos":[-0.0048,0.0807,-0.0373],"rot":[-0.0000033630744837864768,0.0000033974647521972656,-1.1425927912145362e-11,1]},
	{ "name":"RightHandPinky2","len":0.021,"idx":14,"p_idx":13,"pos":[0,0.036,0],"rot":[0.000011971213098149747,-0.000011956633898080327,-0.0000056385929383395705,1]},
	{ "name":"RightHandPinky3","len":0.02,"idx":15,"p_idx":14,"pos":[0,0.021,0],"rot":[-0.00000802205249783583,0.000008068487659329548,-3.9523754935544275e-7,1]},
];

/*
{ "name":"LeftHand","len":0.039,"idx":9,"p_idx":8,"pos":[0,0.283,0],"rot":[-0.0000016157980553543894,0.000001614453026377305,-9.588043212716002e-7,1]},
{ "name":"LeftHandThumb1","len":0.041,"idx":10,"p_idx":9,"pos":[-0.015,0.024,-0.026],"rot":[-0.22191810607910156,-0.059467192739248276,0.25190043449401855,0.9400862455368042]},
{ "name":"LeftHandThumb2","len":0.034,"idx":11,"p_idx":10,"pos":[0,0.041,0],"rot":[-0.000019305929527035914,0.00003363657015142962,-0.0000676217969157733,1]},
{ "name":"LeftHandThumb3","len":0.03,"idx":12,"p_idx":11,"pos":[0,0.034,0],"rot":[0.011500630527734756,-0.0017704364145174623,0.0036687529645860195,0.9999255537986755]},

{ "name":"LeftHandIndex1","len":0.036,"idx":13,"p_idx":9,"pos":[-0.0051,0.087,-0.035],"rot":[0.000002279914497194113,-0.0000023154120754043106,-7.219787789836118e-7,1]},
{ "name":"LeftHandIndex2","len":0.028,"idx":14,"p_idx":13,"pos":[0,0.036,0],"rot":[-0.000005065046025265474,0.000005125999450683594,-2.465329940193328e-9,1]},
{ "name":"LeftHandIndex3","len":0.02,"idx":15,"p_idx":14,"pos":[0,0.0288,0],"rot":[0.000014023946278030053,-0.00001409131618856918,-0.000004982239261153154,1]},
{ "name":"LeftHandMiddle1","len":0.036,"idx":16,"p_idx":9,"pos":[0,0.094,-0.011],"rot":[0.0000022864619495521765,-0.0000023154120754043106,-7.244172479659028e-7,1]},
{ "name":"LeftHandMiddle2","len":0.029,"idx":17,"p_idx":16,"pos":[0,0.036,0],"rot":[-0.0000030297826469904976,0.000003099441300946637,-9.861094579788343e-12,1]},
{ "name":"LeftHandMiddle3","len":0.02,"idx":18,"p_idx":17,"pos":[0,0.029,0],"rot":[1.3773330920230364e-7,-1.8769137000163028e-7,0.000008413082468905486,1]},
{ "name":"LeftHandRing1","len":0.031,"idx":19,"p_idx":9,"pos":[-0.0004,0.091,0.0137],"rot":[0.0000022736619484930998,-0.0000023154120754043106,-7.243664867928601e-7,1]},
{ "name":"LeftHandRing2","len":0.029,"idx":20,"p_idx":19,"pos":[0,0.031,0],"rot":[-0.0000017625555983613594,0.000001788139229574881,-5.4141510719141195e-11,1]},
{ "name":"LeftHandRing3","len":0.02,"idx":21,"p_idx":20,"pos":[0,0.029,0],"rot":[0.0000031824711186345667,-0.000003104724555669236,0.000009005581887322478,1]},
{ "name":"LeftHandPinky1","len":0.036,"idx":22,"p_idx":9,"pos":[-0.0048,0.0807,0.0373],"rot":[0.0000022765411813452374,-0.0000023154120754043106,-7.243598361128534e-7,1]},
{ "name":"LeftHandPinky2","len":0.021,"idx":23,"p_idx":22,"pos":[0,0.036,0],"rot":[0.000006353253411361948,-0.000006276305157371098,0.000002819155724864686,1]},
{ "name":"LeftHandPinky3","len":0.02,"idx":24,"p_idx":23,"pos":[0,0.021,0],"rot":[-0.000005777703790954547,0.000005574775059358217,-0.000008853048711898737,1]},
*/

const MAXIMO_CONFIG = [
	{ "name":"RightHand","top":[0.04,0.03,0.09,0.073], "bot":[0.05,0.03,0.07,-0.015] },

	{ "name":"RightHandThumb1", "top":[0.03,0.025], "bot":[0.04,0] },
	{ "name":"RightHandThumb2", "top":[0.025,0.018], "bot":[0.025,0] },
	{ "name":"RightHandThumb3", "top":[0.020,0.025], "bot":[0.025,0] },
	
	{ "name":"RightHandIndex1", "top":[0.024,0.0210], "bot":[0.024,0] },
	{ "name":"RightHandIndex2", "top":[0.024,0.016], "bot":[0.024,0] },
	{ "name":"RightHandIndex3", "top":[0.020,0.023], "bot":[0.024,0] },

	{ "name":"RightHandMiddle1", "top":[0.024,0.022], "bot":[0.024,0] },
	{ "name":"RightHandMiddle2", "top":[0.024,0.017], "bot":[0.024,0] },
	{ "name":"RightHandMiddle3", "top":[0.020,0.023], "bot":[0.024,0] },
	
	{ "name":"RightHandRing1", "top":[0.024,0.021], "bot":[0.024,0] },
	{ "name":"RightHandRing2", "top":[0.024,0.016], "bot":[0.024,0] },
	{ "name":"RightHandRing3", "top":[0.020,0.023], "bot":[0.024,0] },
	
	{ "name":"RightHandPinky1", "top":[0.020,0.023], "bot":[0.020,0] },
	{ "name":"RightHandPinky2", "top":[0.02,0.016], "bot":[0.02,0] },
	{ "name":"RightHandPinky3", "top":[0.016,0.023], "bot":[0.02,0.005] },
];

/*
{ "name":"LeftHand", "top":[0.04,0.03,0.09,0.073], "bot":[0.05,0.03,0.07,-0.015] },
	
{ "name":"LeftHandThumb1", "top":[0.03,0.025], "bot":[0.04,0] },
{ "name":"LeftHandThumb2", "top":[0.025,0.018], "bot":[0.025,0] },
{ "name":"LeftHandThumb3", "top":[0.020,0.025], "bot":[0.025,0] },
{ "name":"LeftHandIndex1", "top":[0.024,0.021], "bot":[0.024,0] },
{ "name":"LeftHandIndex2",  "top":[0.024,0.016], "bot":[0.024,0] },
{ "name":"LeftHandIndex3", "top":[0.020,0.023], "bot":[0.024,0] },
{ "name":"LeftHandMiddle1", "top":[0.024,0.022], "bot":[0.024,0] },
{ "name":"LeftHandMiddle2","top":[0.024,0.017], "bot":[0.024,0] },
{ "name":"LeftHandMiddle3", "top":[0.020,0.023], "bot":[0.024,0] },
{ "name":"LeftHandRing1","top":[0.024,0.021], "bot":[0.024,0] },
{ "name":"LeftHandRing2", "top":[0.024,0.016], "bot":[0.024,0] },
{ "name":"LeftHandRing3","top":[0.020,0.023], "bot":[0.024,0] },

{ "name":"LeftHandPinky1","top":[0.020,0.023], "bot":[0.020,0] },
{ "name":"LeftHandPinky2","top":[0.02,0.016], "bot":[0.02,0] },
{ "name":"LeftHandPinky3","top":[0.016,0.023], "bot":[0.02,0.005] },
*/

function ProtoHand( name="ProtoHand", use_preview=false ){
	let e = App.mesh_entity( name );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// CREATE ARMATURE
	let arm = App.ecs.add_com( e.id, "Armature" );
	arm.load_config( MAXIMO_BONES );
	
	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// BONE PREVIEW
	if( use_preview ){
		let bview = App.ecs.add_com( e.id, "BoneView" );
		let mat = App.shader.new_material( "BoneView" ).set_depth_test( true );
		bview.use_armature( arm );
		e.draw.add( bview.mesh, mat, App.mesh.LINE );
	}

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// PROTOFORM
	let pro = App.ecs.add_com( e.id, "ProtoForm" );
	pro.use_armature( arm, MAXIMO_CONFIG );
	e.draw.items.push( pro.get_draw_item() );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	e.proto	= pro;
	e.arm	= arm;
	return e;
}

export default ProtoHand;