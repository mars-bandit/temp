<!DOCTYPE html><script type="module">
import App, { Vec3, Quat, Mat4, Transform } from "../../fungi/App.js";
import FlatGeo		from "../../fungi/geo/FlatGeo.js";
import ProtoForm, { ProtoFormSys, BoneConfig }	from "../../fungi.protoform2/ProtoForm.js";
import PropPanel, { PropProxy }	from "../../sage.ui/PropPanel.js";
//import EyeBall from "../../fungi.protoform/rigs/EyeBall.js";

//#####################################################
App
	.init( true )
	.use_debug()
	.load_pkg( { name:"fungi.armature", bone_view:true, mat:false } )
	//.load_pkg( { name:"fungi.protoform", mat:"Halftone" } )
	//.load_shaders( "LowPoly.js" )
	//.load_shaders( "BaseColor.js" )	
	.load_shaders( "../fungi.protoform2/ShadeDiffuse.js" )	
	.set_camera( 60, 10, 4, 0, 1.0, 0 )
	.task( init )
	.then();

//#####################################################

let Bone_cfg	= new BoneConfig();
let Proxy 		= new PropProxy();
let Bone_idx	= 0;
let Entity		= null;

async function init(){
	App.ecs.systems.reg( ProtoFormSys, 810 );

	let e = build( true );
	Entity = e;

	init_ui();



	/*
	let bc = new BoneConfig().as_shape_shere();
	//bc.pos_top.y = 0.1;
	e.proto
		.set_bone_cfg( "Head", bc )
		.update_config_buffer();
	*/


	/*
	let geo		= verts( 3, 4, 1, 1 ); //lathe_cnt=6, arc_div=6, radius=1, side_step=5
	let mesh	= App.mesh.from_data( "ProtoCapsule", geo.vert, 4, geo.idx, geo.norm );
	let mat		= App.shader.new_material( "LowPoly" );
	let e		= App.mesh_entity( "Capsule", mesh, mat, App.mesh.TRI );
	*/



	/*
	let t = new Vec3();
	let tt = new Vec3();
	for( let i=0; i < geo.vert.length / 4; i++ ){
		t.from_buf( geo.vert, i*4 );
		tt.from_buf( geo.norm, i*3 );

		App.Debug.ln( t, tt.add( t ) );
		//App.Debug.pnt( t, "red", 0.1 );
	}
	*/
	

	/*
	console.log( geo.vert );

	let vcnt = geo.vert.length / 4;
	let v = new Vec3();
	let vv = new Vec3();
	let n = new Vec3();
	for( let i=0; i < (4*3); i+=4 ){
		v.from_buf( geo.vert, i );
		n.from_sub( v, Vec3.UP );

		App.Debug.ln( v, vv.from_add( n, v ) );
	}
	*/

	//e.draw.add( mesh, mat, App.mesh.PNT );


	/*
	let h	= ProtoHuman( "PH", true );
	h.node.set_pos( 1, 0, 0 );

	let arm	= h.arm;

	//let eye = EyeBall();
	//eye.node.set_scl( 0.21 ).set_pos( 0, 0.082, 0.02 );
	//eye.node.set_scl( 0.07 ).set_pos( 0, 0.085, 0.09 );
	//arm.attach_to_bone( "Head", eye.node );

	let d 	= ProtoDino( "PD", true );
	d.node.set_pos( -1, 0, 0 );

	let n = ProtoHand( "hand", false );
	n.node.set_scl( 5 );
	n.node.rot_by( 90, "y" );
	*/

	/*

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	//let e = Capsule( "Test", "LowPoly" );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// STARTING ENTITY ( Node + Draw )
	let e = App.mesh_entity( "test" );
	//console.log( e );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// CREATE ARMATURE
	let arm = App.ecs.add_com( e.id, "Armature" );
	arm.load_config( MAXIMO_BONES );
	
	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// BONE PREVIEW
	let bview	= App.ecs.add_com( e.id, "BoneView" );
	let mat		= App.shader.new_material( "BoneView" ).set_depth_test( true );
	bview.use_armature( arm );
	e.draw.add( bview.mesh, mat, App.mesh.LINE );
	

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	let prig = new ProtoForm();
	prig.use_armature( arm, MAXIMO_CONFIG );
	App.ecs.add_com( e.id, prig );
	e.draw.items.push( prig.get_draw_item() );

	*/

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	//App.render_by( 1, on_render );
	return true;
}

function build( use_preview=true ){
	let e = App.mesh_entity( name );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// CREATE ARMATURE
	e.arm = App.ecs.add_com( e.id, "Armature" );
	e.arm
		//.load_config( DINO_BONES ) // DINO_BONES, MAXIMO_BONES
		.load_config( JINX_BONES )
		.anchor_root_bones( e.node );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// PROTOFORM
	e.proto	= new ProtoForm(); //App.ecs.add_com( e.id, "ProtoForm" );
	e.proto.use_armature( e.arm, null );
	//e.proto.use_config( HUMAN_CONFIG );
	//e.proto.use_config( GUARDIAN_CONFIG );
	//e.proto.use_config( DINO_CONFIG );
	e.proto.use_config( JINX_CONFIG );
	e.draw.add( e.proto.get_draw_item() );
	App.ecs.add_com( e.id, e.proto );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// BONE PREVIEW
	if( use_preview ){
		e.bview = App.ecs.add_com( e.id, "BoneView" );
		e.bview.use_armature( e.arm );
		e.draw.add( e.bview.get_draw_item() );
	}


	//let eye = EyeBall();
	//eye.node.set_scl( 0.2 ).set_pos( 0, 0.5, 0.27 );
	//e.arm.attach_to_bone( "Head", eye.node );
	//e.eye = eye;

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	return e;
}

//#####################################################


function verts( lathe_cnt=6, arc_div=6, radius=1, side_step=5 ){
	let i;
	let t = new Vec3();
	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// BASE SHAPE FOR LATHE

	// Top Arc
	let base = FlatGeo.arc( Math.PI * 0.5, 0, arc_div, radius, 1 );
	base = base.slice( 3 );					// Remove First Vert

	let nbase = new Array();				// Create Normal Direction of Top Arc
	for( i=0; i < base.length; i+=3 ){
		t.from_buf( base, i ).norm();
		nbase.push( t[0], t[1], t[2] );
	}

	FlatGeo.vert_offset( base, 0, 1, 0 );	// Move Arc Into Position

	// Line Between Arcs
	let len			= base.length;		// How Many Verts in Arc
	let y			= 0.7;				// Copy the last point in Arc
	let x			= base[ len-3 ];
	let z			= base[ len-1 ];
	FlatGeo.line_lerp( [x,y,z], [x,-y,z], side_step, base );

	for( i=0; i <= side_step; i++ ) nbase.push( 1, 0, 0 ); // Norm Direction of side.

	// Flip the order of the arc verts and do Y Mirror
	for( i=(arc_div-1) * 3 - 1; i > 0; i -= 3){	
		base.push( base[ i-2 ], -base[ i-1 ], base[ i ] );

		t.set( base[ i-2 ], -base[ i-1 ] + 1, base[ i ] ).norm(); // Compute Normal
		nbase.push( t[0], t[1], t[2] );
	}

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// CREATE ALL VERTICES

	let verts	= FlatGeo.lathe( base, lathe_cnt, "y" );
	let norms	= FlatGeo.lathe( nbase, lathe_cnt, "y" );
	let tip_idx	= verts.length / 3; 

	// Add Top & Bottom Tip
	verts.push(
		0, radius + 1, 0,
		0, -(radius + 1), 0
	);

	norms.push( 0,1,0, 0,-1,0 ); // final points, UP / DOWN.

	/*
	for( i=0; i < verts.length / 3; i++ ){
		t.from_buf( verts, i*3 );
		tt.from_buf( norms, i*3 );

		App.Debug.ln( t, tt.add( t ) );
		//App.Debug.pnt( t, "red", 0.1 );
	}
	*/

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// CREATE INDICES

	let row_size	= base.length / 3; // How many points in each row of the lathe.
	let indices		= FlatGeo.grid_indices( row_size, lathe_cnt, 0, false, false );
	let edge_top	= new Array();
	let edge_bot	= new Array();

	// Create Array of Indexes to of the first and last edge in the shape
	for( i=0; i < lathe_cnt; i++ ){
		edge_top.push( i * row_size );
		edge_bot.push( i * row_size + row_size - 1 );
	}

	FlatGeo.fan_indices( tip_idx, edge_top, false, indices );
	FlatGeo.fan_indices( tip_idx+1, edge_bot, true, indices );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// ASSIGN VERTEX GROUP IDS

	let fvert	= FlatGeo.to_vec4( verts );		// Convert Vec3 buffer to Vec4, for Vertex Group Indexing
	let step_h	= Math.round( side_step / 2 );	// How many points between arcs, In half
	let arc_len	= arc_div - 1;					// How Many Points in the Arc
	
	let j, idx;
	for( i=0; i < lathe_cnt; i++ ){
		// Top Dome
		idx = i * row_size;
		for( j=0; j < arc_len; j++ )	fvert[ (idx + j) * 4 + 3 ]	= 1.0;

		// Upper Cylinder
		idx += arc_len;
		for( j=0; j < step_h; j++ )		fvert[ (idx + j ) * 4 + 3 ]	= 2.0;

		// Lower Cylinder
		idx += step_h;
		for( j=0; j < step_h; j++ )		fvert[ (idx + j ) * 4 + 3 ]	= 3.0;

		// Bottom Dome
		idx += step_h;
		for( j=0; j < arc_len; j++ )	fvert[ (idx + j) * 4 + 3 ]	= 4.0;
	}

	fvert[ tip_idx * 4 + 3 ]		= 1.0;	// Top Point
	fvert[ (tip_idx+1) * 4 + 3 ]	= 4.0;	// Bot Point

	return{ vert:fvert, idx:new Uint16Array( indices ), norm:norms };
}


const MAXIMO_BONES = [
	{ "name":"Hips", "len":0.105, "idx":0,"p_idx":null,"pos":[0,1.039,0.020], "rot":[2.4268916831715615e-7,0,0,1]  },
	{ "name":"Spine", "len":0.097, "idx":1,"p_idx":0,"pos":[0,0.105,0], "rot":[-0.044645827263593674,-8.692448299794618e-27,-4.453656740259141e-20,0.9990028738975525]},

	{ "name":"Spine1", "len":0.093, "idx":2,"p_idx":1,"pos":[0,0.097,0], "rot":[-0.029409686103463173,-3.2960057599844583e-21,4.441442901526913e-20,0.999567449092865]},
	{ "name":"Spine2", "len":0.167, "idx":3,"p_idx":2,"pos":[0,0.093,0], "rot":[0.07400670647621155,3.6727628484210417e-28,9.542332680489529e-27,0.9972577691078186]},
	{ "name":"Neck", "len":0.053, "idx":4, "p_idx":3,"pos":[0,0.1656,-0.0251],"rot":[1.9075930168810373e-8,-1.1470830885815196e-34,-8.605402693567593e-35,1]},
	{ "name":"Head", "len":0.1, "idx":5, "p_idx":4,"pos":[0,0.053,0],"rot":[-1.3502827300726494e-8,-4.0840682940945415e-35,-6.660796967887298e-36,1]},

	{ "name":"LeftShoulder","len":0.108,"idx":6,"p_idx":3,  "pos":[0.045,0.1084,-0.026],"rot":[0.7071067690849304,0.7071067690849304,5.338507236274381e-8,-5.338507236274381e-8]},
	{ "name":"LeftArm","len":0.278,"idx":7,"p_idx":6,  "pos":[-0.005,0.105,-0.022],"rot":[-1.495118037678709e-35,-4.519952057080445e-8,1.1566897702458666e-34,1]},
	{ "name":"LeftForeArm","len":0.283,"idx":8,"p_idx":7,"pos":[0,0.278,0],"rot":[-6.706603130623989e-7,7.00962573318975e-7,0.0000016832213987072464,1]},
	{ "name":"LeftHand","len":0.039,"idx":9,"p_idx":8,"pos":[0,0.283,0],"rot":[-0.0000016157980553543894,0.000001614453026377305,-9.588043212716002e-7,1]},
	
	{ "name":"LeftHandThumb1","len":0.041,"idx":10,"p_idx":9,"pos":[-0.015,0.024,-0.026],"rot":[-0.22191810607910156,-0.059467192739248276,0.25190043449401855,0.9400862455368042]},
	{ "name":"LeftHandThumb2","len":0.034,"idx":11,"p_idx":10,"pos":[0,0.041,0],"rot":[-0.000019305929527035914,0.00003363657015142962,-0.0000676217969157733,1]},
	{ "name":"LeftHandThumb3","len":0.03,"idx":12,"p_idx":11,"pos":[0,0.034,0],"rot":[0.011500630527734756,-0.0017704364145174623,0.0036687529645860195,0.9999255537986755]},
	{ "name":"LeftHandIndex1","len":0.036,"idx":13,"p_idx":9,"pos":[-0.0051,0.087,-0.035],"rot":[0.000002279914497194113,-0.0000023154120754043106,-7.219787789836118e-7,1]},
	{ "name":"LeftHandIndex2","len":0.028,"idx":14,"p_idx":13,"pos":[0,0.036,0],"rot":[-0.000005065046025265474,0.000005125999450683594,-2.465329940193328e-9,1]},
	{ "name":"LeftHandIndex3","len":0.02,"idx":15,"p_idx":14,"pos":[0,0.0288,0],"rot":[0.000014023946278030053,-0.00001409131618856918,-0.000004982239261153154,1]},
	{ "name":"LeftHandMiddle1","len":0.036,"idx":16,"p_idx":9,"pos":[0,0.094,-0.011],"rot":[0.0000022864619495521765,-0.0000023154120754043106,-7.244172479659028e-7,1]},
	{ "name":"LeftHandMiddle2","len":0.029,"idx":17,"p_idx":16,"pos":[0,0.036,0],"rot":[-0.0000030297826469904976,0.000003099441300946637,-9.861094579788343e-12,1]},
	{ "name":"LeftHandMiddle3","len":0.02,"idx":18,"p_idx":17,"pos":[0,0.029,0],"rot":[1.3773330920230364e-7,-1.8769137000163028e-7,0.000008413082468905486,1]},
	{ "name":"LeftHandRing1","len":0.031,"idx":19,"p_idx":9,"pos":[-0.0004,0.091,0.0137],"rot":[0.0000022736619484930998,-0.0000023154120754043106,-7.243664867928601e-7,1]},
	{ "name":"LeftHandRing2","len":0.029,"idx":20,"p_idx":19,"pos":[0,0.031,0],"rot":[-0.0000017625555983613594,0.000001788139229574881,-5.4141510719141195e-11,1]},
	{ "name":"LeftHandRing3","len":0.02,"idx":21,"p_idx":20,"pos":[0,0.029,0],"rot":[0.0000031824711186345667,-0.000003104724555669236,0.000009005581887322478,1]},
	{ "name":"LeftHandPinky1","len":0.036,"idx":22,"p_idx":9,"pos":[-0.0048,0.0807,0.0373],"rot":[0.0000022765411813452374,-0.0000023154120754043106,-7.243598361128534e-7,1]},
	{ "name":"LeftHandPinky2","len":0.021,"idx":23,"p_idx":22,"pos":[0,0.036,0],"rot":[0.000006353253411361948,-0.000006276305157371098,0.000002819155724864686,1]},
	{ "name":"LeftHandPinky3","len":0.02,"idx":24,"p_idx":23,"pos":[0,0.021,0],"rot":[-0.000005777703790954547,0.000005574775059358217,-0.000008853048711898737,1]},
	
	{ "name":"RightShoulder","len":0.108,"idx":25,"p_idx":3,"pos":[-0.045,0.1084,-0.026],"rot":[1.0185958743136325e-8,-1.0185956966779486e-8,0.7071067690849304,0.7071067690849304]},
	{ "name":"RightArm","len":0.278,"idx":26,"p_idx":25,"pos":[-0.005,0.105,0.022],"rot":[3.736904002898115e-35,-1.006445394960507e-15,-5.495755792415194e-35,1]},
	{ "name":"RightForeArm","len":0.283,"idx":27,"p_idx":26,"pos":[0,0.278,0],"rot":[2.1040301589891897e-7,-2.0325643390606274e-7,6.31208195045474e-7,1]},
	{ "name":"RightHand","len":0.039,"idx":28,"p_idx":27,"pos":[0,0.283,0],"rot":[0.000003163138671880006,-0.000003194210648871376,-6.312201321634348e-7,1]},
	
	{ "name":"RightHandPinky1","len":0.036,"idx":29,"p_idx":28,"pos":[-0.0048,0.0807,-0.0373],"rot":[-0.0000033630744837864768,0.0000033974647521972656,-1.1425927912145362e-11,1]},
	{ "name":"RightHandPinky2","len":0.021,"idx":30,"p_idx":29,"pos":[0,0.036,0],"rot":[0.000011971213098149747,-0.000011956633898080327,-0.0000056385929383395705,1]},
	{ "name":"RightHandPinky3","len":0.1,"idx":31,"p_idx":30,"pos":[0,0.021,0],"rot":[-0.00000802205249783583,0.000008068487659329548,-3.9523754935544275e-7,1]},
	{ "name":"RightHandRing1","len":0.031,"idx":32,"p_idx":28,"pos":[-0.0004,0.091,-0.0137],"rot":[-0.000003366203372934251,0.000003397464979570941,-1.1436558297606148e-11,1]},
	{ "name":"RightHandRing2","len":0.029,"idx":33,"p_idx":32,"pos":[0,0.031,0],"rot":[0.000008235279892687686,-0.000008292319762404077,-0.000006086941539251711,1]},
	{ "name":"RightHandRing3","len":0.02,"idx":34,"p_idx":33,"pos":[0,0.029,0],"rot":[-0.000015700450603617355,0.00001574820271343924,0.000015092553439899348,1]},
	{ "name":"RightHandMiddle1","len":0.036,"idx":35,"p_idx":28,"pos":[0,0.094,0.011],"rot":[-0.000003373543677298585,0.0000033974647521972656,1.1594199558762064e-11,1]},
	{ "name":"RightHandMiddle2","len":0.029,"idx":36,"p_idx":35,"pos":[0,0.036,0],"rot":[-0.000003787220066442387,0.0000038214084270293824,-0.000002019868361458066,1]},
	{ "name":"RightHandMiddle3","len":0.02,"idx":37,"p_idx":36,"pos":[0,0.029,0],"rot":[0.000003721492703334661,-0.0000037618035548803164,0.0000020198690435790922,1]},
	{ "name":"RightHandIndex1","len":0.036,"idx":38,"p_idx":28,"pos":[-0.0051,0.087,0.035],"rot":[-0.0000033692147098918213,0.0000033974647521972656,-1.1446789696667459e-11,1]},
	{ "name":"RightHandIndex2","len":0.028,"idx":39,"p_idx":38,"pos":[0,0.036,0],"rot":[0.000005616404450847767,-0.000005643691110890359,-0.0000020674101506301668,1]},
	{ "name":"RightHandIndex3","len":0.02,"idx":40,"p_idx":39,"pos":[0,0.0288,0],"rot":[0.000002786867753457045,-0.000002750003659457434,0.000012031735423079226,1]},
	{ "name":"RightHandThumb1","len":0.041,"idx":41,"p_idx":28,"pos":[-0.015,0.024,0.026],"rot":[0.22176654636859894,0.05947277694940567,0.25208544731140137,0.9400720596313477]},
	{ "name":"RightHandThumb2","len":0.034,"idx":42,"p_idx":41,"pos":[0,0.041,0],"rot":[0.00034027191577479243,-0.00019238849927205592,-0.0003856124822050333,0.9999998211860657]},
	{ "name":"RightHandThumb3","len":0.03,"idx":43,"p_idx":42,"pos":[0,0.034,0],"rot":[-0.011897333897650242,0.00195137073751539,0.004018437582999468,0.9999192357063293]},

	{ "name":"LeftUpLeg","len":0.443,"idx":44,"p_idx":0,"pos":[0.094,-0.067,-0.015],"rot":[-4.371138828673793e-8,0,1,3.406487686135706e-22]},
	{ "name":"LeftLeg","len":0.445,"idx":45,"p_idx":44,"pos":[0,0.443,0],"rot":[0.003196412930265069,0.0000028676147394435247,-1.5653178309094073e-8,0.9999948740005493]},
	{ "name":"LeftFoot","len":0.115,"idx":46,"p_idx":45,"pos":[0,0.445,0],"rot":[0.354154109954834,-0.0000027842902454722207,0.0000010277683486492606,0.935187041759491]},
	{ "name":"LeftToeBase","len":0.1,"idx":47,"p_idx":46,"pos":[0,0.115,0],"rot":[0.4079362452030182,1.7544498120969365e-7,-2.7185055984091377e-8,0.9130104184150696] },

	{ "name":"RightUpLeg","len":0.443,"idx":48,"p_idx":0,"pos":[-0.094,-0.067,-0.015],"rot":[-4.371138828673793e-8,0,1,3.406487686135706e-22]},
	{ "name":"RightLeg","len":0.445,"idx":49,"p_idx":48,"pos":[0,0.443,0],"rot":[0.003213413991034031,-0.000005006765604775865,-1.5807968267722572e-8,0.9999948143959045] },
	{ "name":"RightFoot","len":0.115,"idx":50,"p_idx":49,"pos":[0,0.445,0],"rot":[0.3540933132171631,0.000004626839199772803,-0.0000017285617559537059,0.935210108757019] },
	{ "name":"RightToeBase","len":0.1,"idx":51,"p_idx":50,"pos":[0,0.115,0],"rot":[0.4079799950122833,1.589943821045381e-7,-4.328248692786474e-8,0.9129908680915833] }
];

const HUMAN_CONFIG = [
	{"bone":"Hips", "base_opt":[1,0,1], "scl_top":[0.06,0.04,0.06], "scl_mid":[0.025,0,0.04], "scl_bot":[0.06,0.04,0.06], "pos_top":[0.03,0.09,0], "pos_mid":[0,0,0], "pos_bot":[0.03,-0.09,0], "base_pos":[0,0.01,-0.01], "base_rot":[0,0,0.707106769084934,0.707106769084934]},
	{"bone":"LeftUpLeg", "base_opt":[1,0,0], "scl_top":[0.03,0.03,0.03], "scl_mid":[0.01,0,0.01], "scl_bot":[0.03,0.04,0.03], "pos_top":[0,0.39,0], "pos_mid":[0,0.19,0.02], "pos_bot":[0,-0.02,0], "base_pos":[0,0.02,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftLeg", "base_opt":[1,-0.18,0], "scl_top":[0.03,0.03,0.03], "scl_mid":[0.01,0,0.01], "scl_bot":[0.03,0.03,0.03], "pos_top":[0,0.38,-0.01], "pos_mid":[0,0.29,0.01], "pos_bot":[0,-0.02,0], "base_pos":[0,0.05,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftFoot", "base_opt":[1,0,1], "scl_top":[0.04,0.05,0.03], "scl_mid":[0.04,0.02,0.04], "scl_bot":[0.05,0.05,0.04], "pos_top":[0,0.05,0], "pos_mid":[0,0,0.02], "pos_bot":[0,-0.02,0], "base_pos":[0,0.05,-0.03], "base_rot":[0.3420215547084883,0,0,0.939692616462775]},
	{"bone":"LeftToeBase", "base_opt":[0,0,1], "scl_top":[0.038,0.02,0.01], "scl_mid":[1,1,1], "scl_bot":[0.04,0.02,0.03], "pos_top":[0,0.05,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.02,0.01], "base_rot":[-0.1218693453897858,0,0,0.9925461411476135]},

	{"bone":"RightUpLeg", "base_opt":[1,0,0], "scl_top":[0.03,0.03,0.03], "scl_mid":[0.01,0,0.01], "scl_bot":[0.03,0.04,0.03], "pos_top":[0,0.39,0], "pos_mid":[0,0.19,0.02], "pos_bot":[0,-0.02,0], "base_pos":[0,0.02,0], "base_rot":[0,0,0,1]},
	{"bone":"RightLeg", "base_opt":[1,-0.18,0], "scl_top":[0.03,0.03,0.03], "scl_mid":[0.01,0,0.01], "scl_bot":[0.03,0.03,0.03], "pos_top":[0,0.38,-0.01], "pos_mid":[0,0.29,0.01], "pos_bot":[0,-0.02,0], "base_pos":[0,0.05,0], "base_rot":[0,0,0,1]},
	{"bone":"RightFoot", "base_opt":[1,0,1], "scl_top":[0.04,0.05,0.03], "scl_mid":[0.04,0.02,0.04], "scl_bot":[0.05,0.05,0.04], "pos_top":[0,0.05,0], "pos_mid":[0,0,0.02], "pos_bot":[0,-0.02,0], "base_pos":[0,0.05,-0.03], "base_rot":[0.3420215547084883,0,0,0.939692616462775]},
	{"bone":"RightToeBase", "base_opt":[0,0,1], "scl_top":[0.038,0.02,0.01], "scl_mid":[1,1,1], "scl_bot":[0.04,0.02,0.03], "pos_top":[0,0.05,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.02,0.01], "base_rot":[-0.1218693453897858,0,0,0.9925461411476135]},
	
	{"bone":"Spine", "base_opt":[0,0,1], "scl_top":[0.037,0.037,0.037], "scl_mid":[1,1,1], "scl_bot":[0.045,0.04,0.045], "pos_top":[0,0.033,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.02,0], "base_rot":[0,0,0,1]},
	{"bone":"Spine1", "base_opt":[0,0,1], "scl_top":[0.041,0.04,0.05], "scl_mid":[1,1,1], "scl_bot":[0.037,0.037,0.044], "pos_top":[0,0.003,0], "pos_mid":[0,0,0], "pos_bot":[0,0.016,0], "base_pos":[0,0.05,0], "base_rot":[0,0,0,1]},
	{"bone":"Spine2", "base_opt":[1,0,0], "scl_top":[0.07,0.06,0.07], "scl_mid":[0.06,0.06,0.07], "scl_bot":[0.07,0.06,0.07], "pos_top":[-0.07,0.1000,0], "pos_mid":[0,0,0], "pos_bot":[-0.07,-0.1000,0], "base_pos":[0,0.11,0], "base_rot":[0,0,0.707106769084934,0.707106769084934]},
	{"bone":"Neck", "base_opt":[1,0,1], "scl_top":[0.019,0.019,0.019], "scl_mid":[0.01,0,0.007], "scl_bot":[0.016,0.016,0.016], "pos_top":[0,0.04,0.01], "pos_mid":[0,0,0], "pos_bot":[0,-0.04,0.015], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"Head", "base_opt":[2.0000,0.23,1], "scl_top":[0.07,0.02,0.07], "scl_mid":[0.07,0,0.07], "scl_bot":[0.03,0.02,0.03], "pos_top":[0,0.09,0], "pos_mid":[0,0.01,0.04], "pos_bot":[0,-0.04,0.03], "base_pos":[0,0,0.01], "base_rot":[0,0,0,1]},

	{"bone":"LeftShoulder", "base_opt":[2.0000,0,1], "scl_top":[0.005,0.01,0.005], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.02,0.01], "pos_top":[-0.02,0.06,0], "pos_mid":[0.01,0,0], "pos_bot":[0,-0.03,0], "base_pos":[0.015,0.04,-0.02], "base_rot":[-0.04361938685178757,0,0,0.999048233322266]},
	{"bone":"LeftArm", "base_opt":[1,0,0], "scl_top":[0.025,0.025,0.025], "scl_mid":[0.01,0,0.01], "scl_bot":[0.03,0.03,0.03], "pos_top":[0,0.233,0], "pos_mid":[0,0.15,0], "pos_bot":[0,-0.02,0], "base_pos":[0,0.02,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftForeArm", "base_opt":[1,0,0], "scl_top":[0.018,0.02,0.018], "scl_mid":[0.009,0,0.009], "scl_bot":[0.023,0.023,0.023], "pos_top":[0,0.216,0], "pos_mid":[0,0.14,0], "pos_bot":[0,-0.02,0], "base_pos":[0,0.044,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHand", "base_opt":[0,0,1], "scl_top":[0.018,0.04,0.055], "scl_mid":[1,1,1], "scl_bot":[0.018,0.02,0.04], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.04,0], "base_rot":[0,0,0,1]},

	{"bone":"LeftHandIndex1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandIndex2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandIndex3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"LeftHandMiddle1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandMiddle2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandMiddle3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"LeftHandRing1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandRing2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandRing3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"LeftHandPinky1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandPinky2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandPinky3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"LeftHandThumb1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandThumb2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"LeftHandThumb3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"RightShoulder", "base_opt":[2.0000,0,1], "scl_top":[0.005,0.01,0.005], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.02,0.01], "pos_top":[-0.02,0.06,0], "pos_mid":[0.01,0,0], "pos_bot":[0,-0.03,0], "base_pos":[0.015,0.04,0.02], "base_rot":[0.04361938685178757,0,0,0.999048233322266]},
	{"bone":"RightArm", "base_opt":[1,0,0], "scl_top":[0.025,0.025,0.025], "scl_mid":[0.01,0,0.01], "scl_bot":[0.03,0.03,0.03], "pos_top":[0,0.233,0], "pos_mid":[0,0.15,0], "pos_bot":[0,-0.02,0], "base_pos":[0,0.02,0], "base_rot":[0,0,0,1]},
	{"bone":"RightForeArm", "base_opt":[1,0,0], "scl_top":[0.018,0.02,0.018], "scl_mid":[0.009,0,0.009], "scl_bot":[0.023,0.023,0.023], "pos_top":[0,0.216,0], "pos_mid":[0,0.14,0], "pos_bot":[0,-0.02,0], "base_pos":[0,0.044,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHand", "base_opt":[0,0,1], "scl_top":[0.018,0.04,0.055], "scl_mid":[1,1,1], "scl_bot":[0.018,0.02,0.04], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.04,0], "base_rot":[0,0,0,1]},

	{"bone":"RightHandIndex1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandIndex2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandIndex3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"RightHandMiddle1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandMiddle2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandMiddle3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"RightHandRing1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandRing2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandRing3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"RightHandPinky1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandPinky2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandPinky3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

	{"bone":"RightHandThumb1", "base_opt":[1,0,0], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.01,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.01,0], "base_pos":[0,0.016,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandThumb2", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.008,0,0.008], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,-0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},
	{"bone":"RightHandThumb3", "base_opt":[0,0,1], "scl_top":[0.008,0.008,0.008], "scl_mid":[0.01,0,0.02], "scl_bot":[0.01,0.01,0.01], "pos_top":[0,0.005,0], "pos_mid":[0,0,0], "pos_bot":[0,0.005,0], "base_pos":[0,0.015,0], "base_rot":[0,0,0,1]},

];

const GUARDIAN_BONES = [
	{ "name":"Base", "len":0.5, "idx":0,"p_idx":null, "pos":[0,0,0], "rot":[0,0,0,1]  },
	{ "name":"Head", "len":0.95, "idx":1,"p_idx":0, "pos":[0,0.5,0], "rot":[0,0,0,1]  },
	{ "name":"EarL", "len":0.2, "idx":2,"p_idx":1, "pos":[0.2,0.85,0], "rot":[0,0,0,1]  },
	{ "name":"EarR", "len":0.2, "idx":3,"p_idx":1, "pos":[-0.2,0.85,0], "rot":[0,0,0,1]  },
	{ "name":"Tip", "len":0.2, "idx":4,"p_idx":1, "pos":[0,0.85,0], "rot":[0,0,0,1] },

	{ "name":"arm_a_0", "len":0.2, "idx":5,"p_idx":0, "pos":[0.7,0.07,0], "rot":[0,0,-0.707106769084934,0.707106769084934] },
	{ "name":"arm_a_1", "len":0.2, "idx":6,"p_idx":5, "pos":[0,0.2,0], "rot":[0,0,0,1] },
	{ "name":"arm_a_2", "len":0.2, "idx":7,"p_idx":6, "pos":[0,0.2,0], "rot":[0,0,0,1] },
	{ "name":"arm_a_3", "len":0.2, "idx":8,"p_idx":7, "pos":[0,0.2,0], "rot":[0,0,0,1] },
	{ "name":"arm_a_4", "len":0.2, "idx":9,"p_idx":8, "pos":[0,0.2,0], "rot":[0,0,0,1] },
	{ "name":"arm_a_5", "len":0.2, "idx":10,"p_idx":9, "pos":[0,0.2,0], "rot":[0,0,0,1] },
	{ "name":"arm_a_6", "len":0.1, "idx":11,"p_idx":10, "pos":[0,0.2,0], "rot":[0,0,0,1] },
	{ "name":"hand_a_a0", "len":0.15, "idx":12,"p_idx":11, "pos":[-0.05,0.1,0], "rot":[0,0,0.707106769084934,0.707106769084934] },
	{ "name":"hand_a_a1", "len":0.15, "idx":13,"p_idx":12, "pos":[0,0.15,0], "rot":[0,0,0,1] },
	{ "name":"hand_a_c0", "len":0.15, "idx":14,"p_idx":11, "pos":[0.05,0.1,0], "rot":[0,0,-0.707106769084934,0.707106769084934] },
	{ "name":"hand_a_c1", "len":0.15, "idx":15,"p_idx":14, "pos":[0,0.15,0], "rot":[0,0,0,1] },
];

const GUARDIAN_CONFIG = [
	{"bone":"Base", "base_opt":[1,0.14,0.5000], "scl_top":[0.5000,0.08,0.5000], "scl_mid":[0.6000,0,0.6000], "scl_bot":[0.63,0.07,0.63], "pos_top":[0,0.46,0], "pos_mid":[0,0.18,0], "pos_bot":[0,-0.02,0], "base_pos":[0,0.03,0], "base_rot":[0,0,0,1]},
	{"bone":"Head", "base_opt":[0,0,1], "scl_top":[0.27,0.15,0.27], "scl_mid":[1,1,1], "scl_bot":[0.38,0.02,0.38], "pos_top":[0,0.72,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.06,0], "base_rot":[0,0,0,1]},
	{"bone":"EarL", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.04,0,0.03], "scl_bot":[0.08,0.07,0.08], "pos_top":[0,0.06,0], "pos_mid":[-0.07,-0.01,0], "pos_bot":[0,-0.17,0], "base_pos":[-0.04,0.11,0], "base_rot":[0,0,0.5,0.866025388248142]},
	{"bone":"EarR", "base_opt":[1,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[0.04,0,0.03], "scl_bot":[0.08,0.07,0.08], "pos_top":[0,0.06,0], "pos_mid":[-0.07,-0.01,0], "pos_bot":[0,-0.17,0], "base_pos":[0.04,0.11,0], "base_rot":[0.5,0.866025388248142,4.474483283889441e-10,7.75003228259477e-10]},
	{"bone":"Tip", "base_opt":[0,0,1], "scl_top":[0.01,0.01,0.01], "scl_mid":[1,1,1], "scl_bot":[0.04,0.04,0.04], "pos_top":[0,0.09,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.1000,0], "base_rot":[0,0,0,1]},

	{"bone":"arm_a_0", "base_opt":[0,0,1], "scl_top":[0.1,0.1,0.1], "scl_mid":[1,1,1], "scl_bot":[0.1,0.1,0.1], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"arm_a_1", "base_opt":[0,0,1], "scl_top":[0.1,0.1,0.1], "scl_mid":[1,1,1], "scl_bot":[0.1,0.1,0.1], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"arm_a_2", "base_opt":[0,0,1], "scl_top":[0.1,0.1,0.1], "scl_mid":[1,1,1], "scl_bot":[0.1,0.1,0.1], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"arm_a_3", "base_opt":[0,0,1], "scl_top":[0.1,0.1,0.1], "scl_mid":[1,1,1], "scl_bot":[0.1,0.1,0.1], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"arm_a_4", "base_opt":[0,0,1], "scl_top":[0.1,0.1,0.1], "scl_mid":[1,1,1], "scl_bot":[0.1,0.1,0.1], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"arm_a_5", "base_opt":[0,0,1], "scl_top":[0.1,0.1,0.1], "scl_mid":[1,1,1], "scl_bot":[0.1,0.1,0.1], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"arm_a_6", "base_opt":[0,0,1], "scl_top":[0.1,0.1,0.1], "scl_mid":[1,1,1], "scl_bot":[0.1,0.1,0.1], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},

	{"bone":"hand_a_a0", "base_opt":[0,0,1], "scl_top":[0.03,0.03,0.03], "scl_mid":[1,1,1], "scl_bot":[0.03,0.03,0.03], "pos_top":[0,0.06,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.04,0], "base_rot":[0,0,0,1]},
	{"bone":"hand_a_a1", "base_opt":[3.0000,0,0.56], "scl_top":[0.01,0.02,0.01], "scl_mid":[0.03,-0.01,0.02], "scl_bot":[0.03,0.01,0.03], "pos_top":[0.06,0.13,0], "pos_mid":[0,0.09,0], "pos_bot":[0,0.03,0], "base_pos":[0,-0.025,0], "base_rot":[0,0,0,1]},

	{"bone":"hand_a_c0", "base_opt":[0,0,1], "scl_top":[0.03,0.03,0.03], "scl_mid":[1,1,1], "scl_bot":[0.03,0.03,0.03], "pos_top":[0,0.06,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0.04,0], "base_rot":[0,0,0,1]},
	{"bone":"hand_a_c1", "base_opt":[1,0,1], "scl_top":[0.01,0.02,0.01], "scl_mid":[0.02,0,0.02], "scl_bot":[0.03,0.03,0.03], "pos_top":[-0.04,0.08,0], "pos_mid":[0,0.06,0], "pos_bot":[0,-0.02,0], "base_pos":[0,0.03,0], "base_rot":[0,0,0,1]},
];

const DINO_BONES = [
	{"name":"hips","len":0.2409,"idx":0,"p_idx":null, "pos":[0,1.5999,0.0513],"rot":[3.038739464500395e-7,0.7205613851547241,0.6933911442756653,-2.550459612393752e-7]},
	{"name":"spine1","len":0.4254,"idx":1,"p_idx":0,"pos":[0,0.2409,0],"rot":[0.018432877957820892,1.2677458194332303e-8,-2.2406341315672762e-7,0.9998301267623901]},
	{"name":"spine2","len":0.5004,"idx":2,"p_idx":1, "pos":[0,0.4254,0],"rot":[0.08151549100875854,9.942978067556396e-7,-0.0000021349173948692624,0.9966720938682556]},
	{"name":"neck","len":0.4574,"idx":3,"p_idx":2,"pos":[0,0.5004,0],"rot":[-0.027167245745658875,-9.858557632469456e-7,6.493367550319817e-7,0.9996309280395508]},
	{"name":"head","len":0.55,"idx":4,"p_idx":3, "pos":[0,0.4574785828590393,0],"rot":[-0.08995335549116135,-2.650070314302866e-7,0.0000013838683798894635,0.9959459900856018]},
	
	{"name":"shoulder.L","len":0.1782,"idx":5,"p_idx":1, "pos":[-0.0632,0.8049,0],"rot":[-0.1343054622411728,-0.08170288801193237,0.7023701667785645,0.6942353844642639]},
	{"name":"arm_up.L","len":0.2147,"idx":6,"p_idx":5, "pos":[0,0.1782,0],"rot":[-0.5978032350540161,0.6839662790298462,-0.17942018806934357,0.37766361236572266]},
	{"name":"arm_fore.L","len":0.2443,"idx":7,"p_idx":6, "pos":[0,0.2147,0],"rot":[0.7058572173118591,0.00009812167991185561,-0.0002388480061199516,0.708354115486145]},
	{"name":"hand.L","len":0.1295,"idx":8,"p_idx":7, "pos":[0,0.2443,0],"rot":[0.36829447746276855,0.00018096140411216766,0.0001879366609500721,0.9297091364860535]},
	
	{"name":"finger_a0.L","len":0.0883,"idx":9,"p_idx":8, "pos":[0.0492,0.1234,-0.0003],"rot":[-0.3087947368621826,5.556726137001533e-7,-1.3609601978714636e-7,0.9511287212371826]},
	{"name":"finger_a1.L","len":0.1,"idx":10,"p_idx":9, "pos":[0,0.0883,0],"rot":[-0.3188095986843109,-0.0000013524665973818628,1.3770137741175859e-7,0.9478187561035156]},
	{"name":"finger_b0.L","len":0.0802,"idx":11,"p_idx":8, "pos":[-0.0501,0.1230,-0.0006],"rot":[-0.29034093022346497,-9.611323292801899e-9,5.145425774344403e-8,0.956923246383667]},
	{"name":"finger_b1.L","len":0.1,"idx":12,"p_idx":11, "pos":[0,0.0802,0],"rot":[-0.31688806414604187,-4.4743097760147066e-7,2.0646025689075032e-7,0.948462963104248]},
	
	{"name":"shoulder.R","len":0.1782,"idx":13,"p_idx":1,"pos":[0.0632,0.8349,0],"rot":[-0.1343054175376892,0.08170289546251297,-0.7023704051971436,0.6942351460456848]},
	{"name":"arm_up.R","len":0.2147,"idx":14,"p_idx":13,"pos":[0,0.1782,0],"rot":[0.5978031754493713,0.683966338634491,-0.17942030727863312,-0.3776634931564331]},
	{"name":"arm_fore.R","len":0.2443,"idx":15,"p_idx":14,"pos":[0,0.2147,0],"rot":[0.7058571577072144,-0.00009801638225326315,0.00023875318584032357,0.7083541750907898]},
	{"name":"hand.R","len":0.1295,"idx":16,"p_idx":15,"pos":[0,0.2443,0],"rot":[0.36829447746276855,-0.0001809593813959509,-0.00018794155039358884,0.9297091364860535]},
	
	{"name":"finger_a0.R","len":0.0883,"idx":17,"p_idx":16,"pos":[-0.0492,0.1234,-0.0003],"rot":[-0.30879467725753784,-5.556881887969212e-7,1.361010077971514e-7,0.9511287212371826]},
	{"name":"finger_a1.R","len":0.1,"idx":18,"p_idx":17, "pos":[0,0.0883,0],"rot":[-0.3188095986843109,0.0000013541666703531519,-1.3265248810512276e-7,0.9478187561035156]},
	{"name":"finger_b0.R","len":0.0802,"idx":19,"p_idx":16,"pos":[0.0501,0.1230,-0.0006],"rot":[-0.2903409004211426,9.5958592183365e-9,-5.1449564608674336e-8,0.9569233059883118]},
	{"name":"finger_b1.R","len":0.1,"idx":20,"p_idx":19,"pos":[0,0.0802,0],"rot":[-0.31688815355300903,4.4909725716024695e-7,-2.0147720647401002e-7,0.9484629034996033]},
	
	{"name":"leg_0.L","len":0.6824,"idx":21,"p_idx":0, "pos":[-0.3682,-0.0019,0],"rot":[-0.7205613851547241, 7.525101608507612e-8, -1.7464532930944188e-8, 0.6933911442756653]},
	{"name":"leg_1.L","len":0.5962,"idx":22,"p_idx":21,"pos":[0,0.6824,0],"rot":[1.389984115762917e-14, 1.7941249552677618e-7, -3.0515219545695265e-15, 1]},
	{"name":"leg_2.L","len":0.4033,"idx":23,"p_idx":22,"pos":[0,0.5962,0],"rot":[3.8837472716169698e-22, -5.373496492211416e-7, 2.837178004216992e-23, 1]},
	
	{"name":"foot.L","len":0.1590,"idx":24,"p_idx":23, "pos":[0,0.4033,0],"rot":[0.6393926739692688,3.628278477663116e-7,-2.5215112486876023e-7,0.7688803672790527]},
	{"name":"toe_a0.L","len":0.0928,"idx":25,"p_idx":24,"pos":[-0.0717,0.1534,0],"rot":[-2.5925746882649037e-8,1.7953350095467613e-7,0.22928662598133087,0.9733589291572571] },
	{"name":"toe_a1.L","len":0.1,"idx":26,"p_idx":25, "pos":[0,0.0928,0],"rot":[-4.057931235479373e-8,-1.8153022551814502e-7,-1.1981786940395978e-7,1]},
	{"name":"toe_b0.L","len":0.1053,"idx":27,"p_idx":24,"pos":[0,0.1677,0],"rot":[-1.5791218999083867e-8,5.908116236241767e-7,-1.0553894997517022e-14,1] },
	{"name":"toe_b1.L","len":0.1,"idx":28,"p_idx":27,"pos":[0,0.1053,0],"rot":[-4.531181474476398e-8,-4.722371045318141e-7,-3.565666506629914e-14,1]},
	{"name":"toe_c0.L","len":0.0921,"idx":29,"p_idx":24,"pos":[0.0699,0.1537,0],"rot":[2.3490257206049137e-7,7.702470270487538e-7,-0.23078592121601105,0.9730045795440674] },
	{"name":"toe_c1.L","len":0.1,"idx":30,"p_idx":29,"pos":[0,0.0921,0],"rot":[-1.7926815359860931e-13,-9.430226555195986e-7,2.266179279786229e-7,1] },
	
	{"name":"tail0","len":0.3950,"idx":31,"p_idx":0,"pos":[0,-0.3295,0.0868],"rot":[0.000043130767153343186,0.019211696460843086,0.9998154640197754,-0.000041207309550372884]},
	{"name":"tail1","len":0.4390,"idx":32,"p_idx":31,"pos":[0,0.3950,0],"rot":[-3.0723953159395023e-7,0.00004249659104971215,-0.000042428400774952024,1]},
	{"name":"tail2","len":0.4516,"idx":33,"p_idx":32,"pos":[0,0.4390,0],"rot":[-3.275013249416821e-14,9.539368406308313e-9,6.021979789827547e-13,1]},
	{"name":"tail3","len":0.3606,"idx":34,"p_idx":33,"pos":[0,0.4516,0],"rot":[1.6525058299521334e-7,1.845068802602823e-12,1.0934796904754629e-13,1]},
	{"name":"tail4","len":0.3126,"idx":35,"p_idx":34, "pos":[0,0.3606,0],"rot":[-3.558520518254227e-7,-3.145555952483673e-15,-2.35280165575974e-13,1]},
	{"name":"tail5","len":0.2065,"idx":36,"p_idx":35,"pos":[0,0.3126,0],"rot":[1.906014261976452e-7,1.1920926823449918e-7,1.4883890832057683e-13,1]},
	{"name":"tail6","len":0.1,"idx":37,"p_idx":36, "top":[0.05,0.1], "bot":[0.1,0], "pos":[0,0.2065,0],"rot":[6.884149317493236e-15,-1.1918253051135252e-7,2.782902263657872e-17,1]},

	{"name":"leg_0.R","len":0.6824,"idx":38,"p_idx":0,"pos":[0.3682,-0.0019,0],"rot":[-0.7205613851547241, 5.32519550233701e-7, -4.926509404867829e-7, 0.6933911442756653]},
	{"name":"leg_1.R","len":0.5962,"idx":39,"p_idx":38,"pos":[0,0.6824,0],"rot":[-1.3867997801010092e-14, -2.0126897481986816e-7, -4.5259392886026414e-15, 1]},
	{"name":"leg_2.R","len":0.4033,"idx":40,"p_idx":39,"pos":[0,0.5962,0],"rot":[-2.6553610903461636e-22, 5.373501608119113e-7, -8.770604769167695e-23, 1]},
	
	{"name":"foot.R","len":0.1590,"idx":41,"p_idx":40,"pos":[0,0.4033,0],"rot":[0.6393924951553345,-2.787829487260751e-7,2.8139376695435203e-7,0.7688804864883423] },
	{"name":"toe_a0.R","len":0.0928,"idx":42,"p_idx":41,"pos":[0.0717,0.1534,0],"rot":[5.872381336757826e-8,-5.923289947418198e-8,-0.2292865812778473,0.9733589887619019]},
	{"name":"toe_a1.R","len":0.1,"idx":43,"p_idx":42, "pos":[0,0.0928,0],"rot":[-4.057930880208005e-8,4.419701227220685e-8,1.199775567783945e-7,1]},
	{"name":"toe_b0.R","len":0.1053,"idx":44,"p_idx":41, "pos":[0,0.1677,0],"rot":[6.5607981269977245e-9,-6.273558028624393e-7,-3.607205425879738e-15,1] },
	{"name":"toe_b1.R","len":0.1,"idx":45,"p_idx":44,"pos":[0,0.1053,0],"rot":[-4.531177921762719e-8,5.318430567058385e-7,2.924194225520718e-14,1]},
	{"name":"toe_c0.R","len":0.0921,"idx":46,"p_idx":41,"pos":[-0.0699,0.1537,0],"rot":[2.8437952437343483e-7,-0.0000010440704727443517,0.23078593611717224,0.9730045795440674]},
	{"name":"toe_c1.R","len":0.1,"idx":47,"p_idx":46,"pos":[0,0.0921,0],"rot":[-2.697945491146603e-13,0.0000010533635759202298,-2.5324561647721566e-7,1] }
];

const DINO_CONFIG = [
	{"bone":"hips", "base_opt":[0,0,1], "scl_top":[0.37,0.24,0.33], "scl_mid":[1,1,1], "scl_bot":[0.37,0.34,0.33], "pos_top":[0,0,0], "pos_mid":[0,0,0], "pos_bot":[0,0,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"spine1", "base_opt":[0,0,1], "scl_top":[0.37,0.37,0.29], "scl_mid":[1,1,1], "scl_bot":[0.36,0.37,0.29], "pos_top":[0,0.03,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"spine2", "base_opt":[0,0,1], "scl_top":[0.25,0.25,0.25], "scl_mid":[1,1,1], "scl_bot":[0.25,0.25,0.25], "pos_top":[0,0.24,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"neck", "base_opt":[0,0,1], "scl_top":[0.2000,0.2000,0.2000], "scl_mid":[1,1,1], "scl_bot":[0.2000,0.2000,0.2000], "pos_top":[0,0.24,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"head", "base_opt":[1,0.53,1], "scl_top":[0.15,0.15,0.15], "scl_mid":[0.24,0.24,0.22], "scl_bot":[0.26,0.26,0.26], "pos_top":[0,0.46,-0.11], "pos_mid":[0,0.16,-0.06], "pos_bot":[0,-0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},

	{"bone":"tail0", "base_opt":[0,0,1], "scl_top":[0.21,0.21,0.21], "scl_mid":[1,1,1], "scl_bot":[0.21,0.21,0.21], "pos_top":[0,0.19,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"tail1", "base_opt":[0,0,1], "scl_top":[0.18,0.18,0.18], "scl_mid":[1,1,1], "scl_bot":[0.18,0.18,0.18], "pos_top":[0,0.26,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"tail2", "base_opt":[0,0,1], "scl_top":[0.15,0.15,0.15], "scl_mid":[1,1,1], "scl_bot":[0.15,0.15,0.15], "pos_top":[0,0.3000,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"tail3", "base_opt":[0,0,1], "scl_top":[0.11,0.11,0.11], "scl_mid":[1,1,1], "scl_bot":[0.11,0.11,0.11], "pos_top":[0,0.25,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"tail4", "base_opt":[0,0,1], "scl_top":[0.07,0.07,0.07], "scl_mid":[1,1,1], "scl_bot":[0.07,0.07,0.07], "pos_top":[0,0.24,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"tail5", "base_opt":[0,0,1], "scl_top":[0.04,0.04,0.04], "scl_mid":[1,1,1], "scl_bot":[0.04,0.04,0.04], "pos_top":[0,0.17,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"tail6", "base_opt":[0,0,1], "scl_top":[0.02,0.02,0.02], "scl_mid":[1,1,1], "scl_bot":[0.03,0.03,0.03], "pos_top":[0,0.08,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},

	{"bone":"leg_0.L", "base_opt":[0,0,1], "scl_top":[0.15,0.15,0.15], "scl_mid":[1,1,1], "scl_bot":[0.19,0.15,0.19], "pos_top":[0,0.53,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"leg_1.L", "base_opt":[0,0,1], "scl_top":[0.11,0.11,0.11], "scl_mid":[1,1,1], "scl_bot":[0.13,0.13,0.13], "pos_top":[0,0.47,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
	{"bone":"leg_2.L", "base_opt":[0,0,1], "scl_top":[0.06,0.06,0.06], "scl_mid":[1,1,1], "scl_bot":[0.09,0.09,0.09], "pos_top":[0,0.32,0], "pos_mid":[0,0,0], "pos_bot":[0,0.02,0], "base_pos":[0,0,0], "base_rot":[0,0,0,1]},
];

const JINX_BONES = [
	{"name":"hip","len":0.04887452721595764,"idx":0,"p_idx":null,"pos":[0,0.3813585042953491,4.952967103122319e-8],"rot":[0,1.1920928955078125e-7,0,1]},
	{"name":"spine.0","len":0.048642754554748535,"idx":1,"p_idx":0,"pos":[0,0.04887452721595764,0],"rot":[0,-1.1920928955078125e-7,0,1]},
	{"name":"spine.1","len":0.09374162554740906,"idx":2,"p_idx":1,"pos":[0,0.048642754554748535,0],"rot":[0,1.1920928955078125e-7,0,1]},
	{"name":"spine.2","len":0.16781854629516602,"idx":3,"p_idx":2,"pos":[0,0.09374162554740906,0],"rot":[0,0,0,1]},
	{"name":"neck","len":0.0389065146446228,"idx":4,"p_idx":3,"pos":[0,0.16781854629516602,0],"rot":[0,-7.105427357601002e-15,0,1]},
	{"name":"head","len":0.38133754220468075,"idx":5,"p_idx":4,"pos":[0,0.0389065146446228,0],"rot":[0,0,0,1]},
	{"name":"ear.l","len":0.1,"idx":6,"p_idx":5,"pos":[0.15305176377296448,0.3492756485939026,3.0903908765367305e-8],"rot":[7.079385255792658e-8,-1.8000210388890991e-7,-0.34201863408088684,0.9396932721138]},
	{"name":"ear.r","len":0.1,"idx":7,"p_idx":5,"pos":[-0.15305176377296448,0.3492756485939026,-4.2076855777395394e-8],"rot":[-1.0749737100468337e-8,-4.4038262814183327e-8,0.34201863408088684,0.9396932721138]},
	{"name":"arm.l.0","len":0.20677294138763766,"idx":8,"p_idx":3,"pos":[0.07022689282894135,0.09946686029434204,0.006240016780793667],"rot":[0.7074113488197327,0.7067425847053528,-0.006487236358225346,0.006481272634118795]},
	{"name":"arm.l.1","len":0.20677298626024662,"idx":9,"p_idx":8,"pos":[3.710010787472129e-8,0.20677293837070465,-3.069544618483633e-10],"rot":[2.7921585044055064e-9,-3.7718598377978196e-7,1.442390100692137e-7,1]},
	{"name":"hand.l","len":0.0658744817057813,"idx":10,"p_idx":9,"pos":[-3.9872247725725174e-8,0.20677296817302704,1.3706085155718029e-9],"rot":[-0.000008677317055116873,-0.00000362331093128887,-0.00047295738477259874,0.9999998807907104]},
	{"name":"fingerb.l.0","len":0.050478659740242696,"idx":11,"p_idx":10,"pos":[0.0004743118479382247,0.0605902224779129,0.025846650823950768],"rot":[0.00000866924619913334,0.00000458117619928089,0.0004722355224657804,0.9999998807907104]},
	{"name":"fingerb.l.1","len":0.1,"idx":12,"p_idx":11,"pos":[1.4028046280145645e-8,0.05047868564724922,-4.083631210960448e-10],"rot":[1.604252020115382e-8,-0.0000011799836556747323,0.00000118129059956118,1]},
	{"name":"fingera.l.0","len":0.050478659683973616,"idx":13,"p_idx":10,"pos":[-0.0005314966547302902,0.0605902224779129,-0.028964124619960785],"rot":[0.00000866924619913334,0.00000458117619928089,0.0004722355224657804,0.9999998807907104]},
	{"name":"fingera.l.1","len":0.1,"idx":14,"p_idx":13,"pos":[5.925539880990982e-8,0.05047868564724922,2.3856046027503908e-9],"rot":[1.604252020115382e-8,-0.0000011799836556747323,0.00000118129059956118,1]},
	{"name":"thumb.l.0","len":0.037352771124575704,"idx":15,"p_idx":10,"pos":[-0.0011739166220650077,0.056101396679878235,-0.06397233158349991],"rot":[0.000011663744771794882,0.000007769095645926427,0.0006381805869750679,0.9999998807907104]},
	{"name":"thumb.l.1","len":0.1,"idx":16,"p_idx":15,"pos":[5.1048118621110916e-8,0.03735276684165001,1.4851138985250145e-8],"rot":[7.152227965434577e-8,-0.0000017164561540994328,0.0000015956393326632679,1]},
	{"name":"arm.r.0","len":0.20677294138763766,"idx":17,"p_idx":3,"pos":[-0.07022689282894135,0.09946686029434204,0.006239983253180981],"rot":[0.7074113488197327,-0.7067425847053528,0.006487404927611351,0.00648110406473279]},
	{"name":"arm.r.1","len":0.20677298626024662,"idx":18,"p_idx":17,"pos":[-3.712921170517802e-8,0.20677293837070465,-4.706635081674904e-10],"rot":[2.4975443935204567e-9,3.771858132495254e-7,-1.4416897897717718e-7,1]},
	{"name":"hand.r","len":0.0658744817057813,"idx":19,"p_idx":18,"pos":[3.9872247725725174e-8,0.20677296817302704,1.36969902087003e-9],"rot":[-0.000008677317055116873,0.00000362331093128887,0.00047295738477259874,0.9999998807907104]},
	{"name":"fingerb.r.0","len":0.050478659740242696,"idx":20,"p_idx":19,"pos":[-0.0004743118479382247,0.0605902224779129,0.025846650823950768],"rot":[0.00000866924619913334,-0.00000458117619928089,-0.0004722355224657804,0.9999998807907104]},
	{"name":"fingerb.r.1","len":0.1,"idx":21,"p_idx":20,"pos":[-1.4028046280145645e-8,0.05047868564724922,-4.083631210960448e-10],"rot":[1.604252020115382e-8,0.0000011799836556747323,-0.00000118129059956118,1]},
	{"name":"fingera.r.0","len":0.050478659683973616,"idx":22,"p_idx":19,"pos":[0.0005314966547302902,0.0605902224779129,-0.028964124619960785],"rot":[0.00000866924619913334,-0.00000458117619928089,-0.0004722355224657804,0.9999998807907104]},
	{"name":"fingera.r.1","len":0.1,"idx":23,"p_idx":22,"pos":[-5.925539880990982e-8,0.05047868564724922,2.3856046027503908e-9],"rot":[1.604252020115382e-8,0.0000011799836556747323,-0.00000118129059956118,1]},
	{"name":"thumb.r.0","len":0.037352771124575704,"idx":24,"p_idx":19,"pos":[0.0011739166220650077,0.056101396679878235,-0.06397233158349991],"rot":[0.000011663744771794882,-0.000007769095645926427,-0.0006381805869750679,0.9999998807907104]},
	{"name":"thumb.r.1","len":0.1,"idx":25,"p_idx":24,"pos":[-5.1048118621110916e-8,0.03735276684165001,1.4851138985250145e-8],"rot":[7.152227965434577e-8,0.0000017164561540994328,-0.0000015956393326632679,1]},
	{"name":"leg.l.0","len":0.20113365352153778,"idx":26,"p_idx":0,"pos":[0.07504893839359283,0.000694960355758667,1.7893061254881104e-8],"rot":[-1.6292068494294654e-7,0,1,0]},
	{"name":"leg.l.1","len":0.2,"idx":27,"p_idx":26,"pos":[-4.3298697960381105e-15,0.20113365352153778,4.440892098500626e-16],"rot":[0,-7.105427357601002e-15,0,1]},
	{"name":"leg.r.0","len":0.20113365352153778,"idx":28,"p_idx":0,"pos":[-0.07504893839359283,0.000694960355758667,-1.7893061254881104e-8],"rot":[-7.549790126404332e-8,0,1,0]},
	{"name":"leg.r.1","len":0.2,"idx":29,"p_idx":28,"pos":[4.3298697960381105e-15,0.20113365352153778,-1.7763568394002505e-15],"rot":[0,0,0,1]},
	{"name":"tail.0","len":0.08,"idx":30,"p_idx":0,"pos":[0,0.04578608274459839,0],"rot":[-0.7071068286895752,0,-1.685874053691805e-7,0.7071068286895752]},
	{"name":"tail.1","len":0.08,"idx":31,"p_idx":30,"pos":[0,0.08,0],"rot":[0,0,0,1]},
	{"name":"tail.2","len":0.08,"idx":32,"p_idx":31,"pos":[0,0.08,0],"rot":[0,0,0,1]},
	{"name":"tail.3","len":0.08,"idx":33,"p_idx":32,"pos":[0,0.08,0],"rot":[0,0,0,1]},
	{"name":"tail.4","len":0.08,"idx":34,"p_idx":33,"pos":[0,0.08,0],"rot":[0,0,0,1]},
	{"name":"tail.5","len":0.08,"idx":35,"p_idx":34,"pos":[0,0.08,0],"rot":[0,0,0,1]}
];


const JINX_CONFIG = [
	{"bone":"head", "base_opt":[0,0,1], "scl_top":[0.21,0.2000,0.21], "scl_mid":[1,1,1], "scl_bot":[0.21,0.2000,0.21], "pos_top":[0,0.02,0], "pos_mid":[0,0,0], "pos_bot":[0,0.01,0], "base_pos":[0,0.21,0], "base_rot":[0.707106769084934,0,0,0.707106769084934]},
];
//#####################################################
function init_ui(){
	//console.log( Entity );
	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// Setup Proxy to Update Data between Model and UI
	Proxy.add( "scl_top", "scl_top", "input" );
	Proxy.add( "scl_mid", "scl_mid", "input" );
	Proxy.add( "scl_bot", "scl_bot", "input" );
	Proxy.add( "pos_top", "pos_top", "input" );
	Proxy.add( "pos_mid", "pos_mid", "input" );
	Proxy.add( "pos_bot", "pos_bot", "input" );
	Proxy.add( "base_pos", "base_pos", "input" );
	Proxy.add( "base_rot", "base_rot", "input" );
	Proxy.add( "curve_1d", "curve_1d", "input" );
	Proxy.add( "mode", "rend_mode", "change" );
	Proxy.add( "bone_sel", "bone_sel", "change" );

	// User Input Handling
	Proxy.on( "ui_input", e=>{
		let i = e.detail,
			v = i.new_val;

		//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		// How to handle specific variables
		switch( i.key ){
			case "mode"		: 
				Bone_cfg.mode = parseInt( v );
				update_mode();
				update_ui();
			break;
			case "bone_sel"	: 
				Bone_idx = parseInt( v );
				get_protoform_bone();
			break;
			case "curve_1d"	: Bone_cfg.set_curve( v[0], v[1] ); break;
			case "base_rot"	: Bone_cfg[ i.key ].from_euler( v[0], v[1], v[2] ); break;
			default			: Bone_cfg[ i.key ].copy( v ); break;
		}

		//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		// Save Data back to ProtoForms & Render
		set_protoform_bone();
		App.render();
	});

	// Program Input Handling
	Proxy.on( "model_input", e=>{
		let i = e.detail,
			v = i.new_val;

		switch( i.key ){
			case "base_rot"	: i.elm.value = v.get_euler( null, true ); break;
			case "bone_sel"	: console.log( "model b sel", v ); break;
			case "mode" 	: i.elm.selectedIndex = v; break;
			default			: i.elm.value = v; break;
		}
	});

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// Build Up Bone Selection Drop Down
	let b, elm = document.getElementById( "bone_sel" );
	for( b of Entity.arm.bones ){
		elm[ b.idx ] = new Option( b.name, b.idx, false );
	}

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// Button Events
	document.getElementById( "btn_serial" ).addEventListener( "click", ()=>{
		let elm = document.getElementById( "bone_sel" );
		console.log( Bone_cfg.serialize( elm[ elm.selectedIndex ].text ) );
	})

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	get_protoform_bone();
}

// Update ProtoForms Bone Config, push to GPU
function set_protoform_bone(){
	Entity.proto
		.set_bone_cfg( Bone_idx, Bone_cfg )
		.update_config_buffer();
}

// Get Bone Config from Protoforms, Update UI with new Data
function get_protoform_bone(){
	Entity.proto.get_bone_config( Bone_idx, Bone_cfg );
	update_ui();
}

// Update the UI from Bone Config Data
function update_ui(){
	Proxy.model.mode		= Bone_cfg.mode;
	Proxy.model.curve_1d	= Bone_cfg.curve;
	Proxy.model.scl_top		= Bone_cfg.scl_top;
	Proxy.model.scl_mid		= Bone_cfg.scl_mid;
	Proxy.model.scl_bot		= Bone_cfg.scl_bot;
	Proxy.model.pos_top		= Bone_cfg.pos_top;
	Proxy.model.pos_mid		= Bone_cfg.pos_mid;
	Proxy.model.pos_bot		= Bone_cfg.pos_bot;
	Proxy.model.base_pos	= Bone_cfg.base_pos;
	Proxy.model.base_rot	= Bone_cfg.base_rot;
}

// How to handle Capsule Morph Mode
function update_mode(){
	console.log( "update mode", Bone_cfg.mode );

	switch( Bone_cfg.mode ){
		case 0: // Linear
			Bone_cfg.pos_top.set(0,0.02,0);
			Bone_cfg.pos_bot.set(0,0.02,0);
			break;
		case 1: // Capped Curve
			Bone_cfg.pos_top.set(0,0.02,0);
			Bone_cfg.pos_bot.set(0,-0.02,0);
			break;
		case 2: case 3: // Full and Simple Curve
			Bone_cfg.pos_top.set(0,0.03,0);
			Bone_cfg.pos_bot.set(0,-0.03,0);
			break;
	}
	Bone_cfg.scl_top.set(0.02,0.02,0.02);
	Bone_cfg.scl_mid.set(0.02,0,0.02);
	Bone_cfg.scl_bot.set(0.02,0.02,0.02);
	Bone_cfg.pos_mid.set(0,0,0);
	Bone_cfg.base_pos.set(0,0,0);
	Bone_cfg.base_rot.set(0,0,0,1);
	Bone_cfg.set_curve( 0, 1 );
}

</script>
<html><head><style>html,body{ margin:0px; padding:0px; width:100%; height:100%; }</style>
</head><body>
	<canvas id="pg_canvas"></canvas>

	<prop-panel id="PntProp" side="right" width="370px" class="Theme" open="true" top="10px">
		<button id="btn_serial"><b>SERIALIZE BONE</b></button>
		<select label="Bone" id="bone_sel"></select>
		<prop-group label="CAPSULE SETTINGS">
			<select label="Deform Mode" id="rend_mode">
				<option value="0">Linear Tube</option>
				<option value="1">Capped Curve</option>
				<option value="2">Full Curve</option>
				<option value="3">Simple Curve</option>
			</select>

			<prop-vector label="Eular Rot"	id="base_rot" value="0,0,0" step="5"></prop-vector>
			<prop-vector label="Offset"		id="base_pos" value="0,0,0" step="0.01"></prop-vector>
			<prop-vector label="Lerp Curve"	id="curve_1d" value="0,1" step="0.01"></prop-vector>
		</prop-group>

		<prop-group label="TOP DOME">
			<prop-vector label="Scale"		id="scl_top" value="1,1,1" step="0.01"></prop-vector>
			<prop-vector label="Position"	id="pos_top" value="0,1,0" step="0.01"></prop-vector>
		</prop-group>

		<prop-group label="MIDDLE ( Curve Modes )" open="false">
			<prop-vector label="Scale"		id="scl_mid" value="1,1,1" step="0.01"></prop-vector>
			<prop-vector label="Position"	id="pos_mid" value="0,0,0" step="0.01"></prop-vector>
		</prop-group>

		<prop-group label="BOTTOM DOME">
			<prop-vector label="Scale"		id="scl_bot" value="1,1,1" step="0.01"></prop-vector>
			<prop-vector label="Position"	id="pos_bot" value="0,1,0" step="0.01"></prop-vector>
		</prop-group>

		<prop-group label="Shapes" open="false">
			<button id="btn_sphere"><b>SPHERE</b></button>
			<button id="btn_projectile"><b>PROJECTILE</b></button>
			<button id="btn_canon"><b>ARM CANNON</b></button>
			<button id="btn_claw"><b>CLAW / FANG</b></button>
		</prop-group>
	</prop-panel>

</body></html>