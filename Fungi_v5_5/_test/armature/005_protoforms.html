<!DOCTYPE html><script type="module">
import App, { Vec3, Quat, Mat4, Transform } from "../../fungi/App.js";
import Capsule		from "../../fungi/geo/Capsule.js";
import ProtoForm	from "../../fungi.protoform/ProtoForm.js";
import ProtoHuman	from "../../fungi.protoform/rigs/ProtoHuman.js";
import ProtoDino	from "../../fungi.protoform/rigs/ProtoDino.js";
import ProtoHand	from "../../fungi.protoform/rigs/ProtoHand.js";
import EyeBall		from "../../fungi.protoform/rigs/EyeBall.js";

//#####################################################
App
	.init( true )
	.load_pkg( { name:"fungi.armature", bone_view:false, mat:false } )
	.load_pkg( { name:"fungi.protoform", mat:"Halftone" } )
	//.load_shaders( "LowPoly.js" )
	.set_camera( 0, 20, 2, 0, 1.3, 0 )
	.task( init )
	.then();

//#####################################################

async function init(){



	
	let h	= ProtoHuman( "PH", true );
	//h.node.set_pos( 1, 0, 0 );

	let arm	= h.arm;

	//let eye = EyeBall();
	//eye.node.set_scl( 0.21 ).set_pos( 0, 0.082, 0.02 );
	//eye.node.set_scl( 0.07 ).set_pos( 0, 0.085, 0.09 );
	//arm.attach_to_bone( "Head", eye.node );

	/*

	let d 	= ProtoDino();
	d.node.set_pos( -1, 0, 0 );

	let n = ProtoHand( "hand", false );
	n.node.set_scl( 5 );
	n.node.rot_by( 90, "y" );
	*/

	/*

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	//let e = Capsule( "Test", "LowPoly" );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// STARTING ENTITY ( Node + Draw )
	let e = App.mesh_entity( "test" );
	//console.log( e );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// CREATE ARMATURE
	let arm = App.ecs.add_com( e.id, "Armature" );
	arm.load_config( MAXIMO_BONES );
	
	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	// BONE PREVIEW
	let bview	= App.ecs.add_com( e.id, "BoneView" );
	let mat		= App.shader.new_material( "BoneView" ).set_depth_test( true );
	bview.use_armature( arm );
	e.draw.add( bview.mesh, mat, App.mesh.LINE );
	

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	let prig = new ProtoForm();
	prig.use_armature( arm, MAXIMO_CONFIG );
	App.ecs.add_com( e.id, prig );
	e.draw.items.push( prig.get_draw_item() );

	*/


	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	/*
    arm.get_node( "RightUpLeg" ).rot_by( 65, "x" );
	arm.get_node( "RightLeg" ).rot_by( -90, "x" );
	arm.get_node( "LeftUpLeg" ).rot_by( -10, "x" );
	arm.get_node( "LeftLeg" ).rot_by( -20, "x" );
    arm.get_node( "Spine" ).rot_by( -20, "x" );
    arm.get_node( "Spine1" ).rot_by( -20, "x" );
	arm.get_node( "Neck" ).rot_by( -30, "x" );
	arm.get_node( "Head" ).rot_by( -10, "x" );
	arm.get_node( "LeftArm" ).rot_by( 20, "z" );
	arm.get_node( "LeftForeArm" ).rot_by( -40, "x" );
	arm.get_node( "RightArm" ).rot_by( 40, "z" );
	arm.get_node( "RightForeArm" ).rot_by( 40, "x" );
	arm.get_node( "RightFoot" ).rot_by( -40, "x" );
	arm.get_node( "LeftFoot" ).rot_by( -20, "x" );
	
	
    arm.get_node( "RightUpLeg" ).rot_by( 65, "x" );
	arm.get_node( "RightLeg" ).rot_by( -90, "x" );
	arm.get_node( "LeftUpLeg" ).rot_by( -10, "x" );
	arm.get_node( "LeftLeg" ).rot_by( -20, "x" );
    arm.get_node( "Spine" ).rot_by( -40, "x" );
    arm.get_node( "Spine1" ).rot_by( -40, "x" );
	arm.get_node( "Neck" ).rot_by( 40, "x" );
	arm.get_node( "Head" ).rot_by( 30, "x" );
	arm.get_node( "Hips" ).rot_by( -60, "x" );
	

	arm.get_node( "RightUpLeg" ).rot_by( 65, "x" );
	arm.get_node( "RightLeg" ).rot_by( -90, "x" );
	arm.get_node( "LeftUpLeg" ).rot_by( -10, "x" );
	arm.get_node( "LeftLeg" ).rot_by( -20, "x" );
    arm.get_node( "Spine" ).rot_by( -20, "x" );
    arm.get_node( "Spine1" ).rot_by( -20, "x" );
	arm.get_node( "Neck" ).rot_by( 20, "x" );
	arm.get_node( "Head" ).rot_by( 10, "x" );
	arm.get_node( "LeftArm" ).rot_by( 20, "z" );
	arm.get_node( "LeftForeArm" ).rot_by( -40, "x" );
	arm.get_node( "RightArm" ).rot_by( 40, "z" );
	arm.get_node( "RightForeArm" ).rot_by( 40, "x" );
	arm.get_node( "RightFoot" ).rot_by( -40, "x" );
	arm.get_node( "LeftFoot" ).rot_by( -20, "x" );
	*/

	//arm.get_node( "Head" ).rot_by( 30, "y" ).rot_by( 10, "x" );
	//eye.node.rot_by( -10, "x" );

	//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	//App.render_by( 1, on_render );
	return true;
}

//#####################################################

</script>
<html><head><style>html,body{ margin:0px; padding:0px; width:100%; height:100%; }</style>
</head><body><canvas id="pg_canvas"></canvas></body></html>